syntax = "proto3";

package auth.v1;

service AuthService {
  rpc SendOtp (SendOtpRequest) returns (SendOtpResponse);
  rpc VerifyOtp (VerifyOtpRequest) returns (VerifyOtpResponse);

  rpc GetAuthUrl (GetAuthUrlRequest) returns (GetAuthUrlResponse);
  rpc Callback (CallbackRequest) returns (CallbackResponse);
  rpc TelegramRegister (TelegramRegisterRequest) returns (TelegramRegisterResponse);

  rpc GetUser(GetUserRequest) returns (GetUserResponse);
}

message SendOtpRequest {
  string identifier = 1;  
  string type = 2;
}

message SendOtpResponse {
  bool ok = 1;
}

message VerifyOtpRequest {
  string identifier = 1;
  string code = 2;
  string type = 3;  
}

message VerifyOtpResponse {
  string token = 1;
}

message GetAuthUrlRequest {}

message GetAuthUrlResponse {
  string url = 1;
}

message CallbackRequest {
  map<string, string> query = 1;      
}

message CallbackResponse {
  string url = 1;
}

message TelegramRegisterRequest {
  string telegram_id = 1;
  string phone = 2;
  string username = 3;
}

message TelegramRegisterResponse {
  bool ok = 1;
  string token = 2;
}

message GetUserRequest {
  string id = 1;
}

message GetUserResponse {
  string id = 1;
  string phone = 2;
}