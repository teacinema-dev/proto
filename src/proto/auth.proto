syntax = "proto3";

package auth.v1;

service AuthService {
  rpc PhoneSendCode (PhoneSendCodeRequest) returns (PhoneSendCodeResponse);
  rpc PhoneVerifyCode (PhoneVerifyCodeRequest) returns (PhoneVerifyCodeResponse);

  rpc GetAuthUrl (GetAuthUrlRequest) returns (GetAuthUrlResponse);
  rpc Callback (CallbackRequest) returns (CallbackResponse);
  rpc TelegramRegister (TelegramRegisterRequest) returns (TelegramRegisterResponse);

  rpc GetUser(GetUserRequest) returns (GetUserResponse);
}

message PhoneSendCodeRequest {
  string phone = 1;
}

message PhoneSendCodeResponse {
  bool ok = 1;
}

message PhoneVerifyCodeRequest {
  string phone = 1;
  string code = 2;
}

message PhoneVerifyCodeResponse {
  bool ok = 1;
  string token = 2;
}

message GetAuthUrlRequest {}

message GetAuthUrlResponse {
  string url = 1;
}

message CallbackRequest {
  map<string, string> query = 1;      
}

message CallbackResponse {
  string url = 1;
}

message TelegramRegisterRequest {
  string telegram_id = 1;
  string phone = 2;
  string username = 3;
}

message TelegramRegisterResponse {
  bool ok = 1;
  string token = 2;
}

message GetUserRequest {
  string id = 1;
}

message GetUserResponse {
  string id = 1;
  string phone = 2;
}