syntax = "proto3";

package auth.v1;

service AuthService {
  rpc PhoneSendCode (PhoneSendCodeRequest) returns (PhoneSendCodeResponse);
  rpc PhoneVerifyCode (PhoneVerifyCodeRequest) returns (PhoneVerifyCodeResponse);
  rpc Introspect (IntrospectRequest) returns (IntrospectResponse);
}

message PhoneSendCodeRequest {
  string phone = 1;
}

message PhoneSendCodeResponse {
  bool ok = 1;
  string message = 2;
  string userId = 3;
}

message PhoneVerifyCodeRequest {
  string phone = 1;
  string code = 2;
}

message PhoneVerifyCodeResponse {
  bool ok = 1;
  string accessToken = 2;
  string refreshToken = 3;
}

message IntrospectRequest {
  string accessToken = 1;
}

message IntrospectResponse {
  bool active = 1;
  string userId = 2;
  repeated string roles = 3;
}
